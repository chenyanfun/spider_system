# 爬虫系统设计文档，开发排期--v0.1版本（2018-第四季度）
- 文档说明：第四季度爬虫框架开发需求，流程设计图，模块设计图，本季度主要完成，调度模块，爬取模块，12月中旬之后能够投入测试阶段

## 爬虫流程图设计

![爬虫流程图](https://raw.githubusercontent.com/chenyanfun/spider_system/master/system_img/%E7%88%AC%E8%99%AB%E6%B5%81%E7%A8%8B%E5%9B%BE.jpg "爬虫流程图")

### 模块说明
1. Schedule：调度器；
1. Crawler：爬取模块；
1. Parse：解析模块；
1. Persistence：数据持久化。

## 调度器设计
![调度器](https://raw.githubusercontent.com/chenyanfun/spider_system/master/system_img/Scheduler.jpg "调度器")

#### 调度器设计排期表
| 名称  | 描述  | 目标形式  | 指派人  | 预期完成时间  | 实际完成时间  |  验收人 |  备注 |
| ------------ | ------------ | ------------ | ------------ | ------------ | ------------ | ------------ | ------------ |
| 配置文件  | 爬取的需求说明，包括需要爬取的数据格式，周期等  | 文本文件  | Eileen  |  12月初 |   |   |   |
| 资源状态判断  | 在做数据爬取之前对网站的一个状态判定，包括服务是否存在，平均响应时间判定  |   | 脚本  |  Eileen | 12月10日前  |   |   |
| 日志模块  |  调度过程日志需求 | 脚本  | Eileen  |11月中旬   |   |   |   |
| 定时器  | 定时启动脚本任务  |  脚本 | Vinndy  |  12月初 |   |   |   |
| 去重模块  | 去除重复数据请求 |  脚本 |  Eileen |  12月初 |   |   |   |
| url生成器  | 去除重复url，给出正确可以爬取的url地址  | 脚本，接口调用  |  Vinndy | 12月初  |   |   |   |


## 爬取模块设计
![crawler](https://raw.githubusercontent.com/chenyanfun/spider_system/master/system_img/crawler.jpg "crawler")

#### 模块构成时间排期表格

|  名称 | 描述  | 目标形式  |  指派人 |  预期完成时间 | 实际完成时间  |  验收人 | 备注  |
| ------------ | ------------ | ------------ | ------------ | ------------ | ------------ | ------------ | ------------ |
| session池  | session池，cookie管理主流网站的登录  |  脚本 | Eileen  |  11月底 |   |   |   |
| 请求池httpApi  |  请求池 |  脚本，接口 |  Eileen | 11月中旬  |   |   |   |
| 代理池  |  IP代理池 | 脚本，接口  | Vinddy  | 11月中旬  |   |   |   |
| UA池  | User-Agent，提供各种浏览器的伪装  |   脚本，接口|  Vinddy | 11月中旬  |   |   |   |
| 中间件  | 接收url，发送新的url  |  脚本 |  Vinddy | 11月中旬  |   |   |   |
| 日志模块  |  收集爬取的正常，报警，错误信息等 | 调用接口  | Eileen  |  11月中旬 |   |   |   |


##### 1、session管理池开发排期表
开发步骤
- 调研各个网站的登录结构，找到预期困难点---时间节点：十一月中旬
- 采用公共账号管理所有网站，文本方式管理---时间节点：十一月中旬
- 做成公共session池，在爬取数据时调用---时间节点：十一月底

|  网站名称 |  描述 | 预计完成时间  | 实际完成时间  |  完成形式 |  备注 |
| ------------ | ------------ | ------------ | ------------ | ------------ | ------------ |
| 知乎  | 用户名,密码登陆  |   |   |   |   |
| 微博 | 用户名,密码登陆  |   |   |   |   |
| 拉勾网  | 用户名，密码登陆  |   |   |   |   |
| CSND博客网  | 用户名，密码登陆  |   |   |   |   |
| Github  | 用户名，密码登陆  |   |   |   |   |
|  B站 | 用户名，密码登陆  |   |   |   |   |
| 豆瓣  | 用户名，密码登陆  |   |   |   |   |
| 珍爱网  | 用户名，密码登陆  |   |   |   |   |
| 果壳网  | 用户名，密码登陆  |   |   |   |   |

##### 2、HttpApiPool 请求池开发排期
##### 3. 代理池开发
- 调研免费代理ip网站 ----11-15
- 采集并维护ip效用性（模块开发）----11-30
- 搭建server（接口开发）----12-10
##### 4.UA池
- 各浏览器的UA收集 ----11-5
-- 手机端和PC端注意区分
- 

##### 6、日志模块
请求模块中的日志模块开发
开发步骤
- 确定日志格式，包括(时间，事件，响应结果) ,确定日志包含内容，正常响应，错误响应，报警信息---时间节点：11月5日；
- 开发日志调用接口---时间节点：11月中旬；

## 解析/存储模块
![解析模块](https://raw.githubusercontent.com/chenyanfun/spider_system/master/system_img/pp.jpg "解析模块")

- 爬虫项目构成
![爬虫项目构成](https://raw.githubusercontent.com/chenyanfun/spider_system/master/system_img/pcxm.jpg "爬虫项目构成")

## 数据存储
采用json格式存储在redis或mongodb中
